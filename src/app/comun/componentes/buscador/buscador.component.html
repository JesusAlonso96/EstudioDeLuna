<app-barra-cargando [cargando]="cargando"></app-barra-cargando>
<mat-card class="container margin-top mb-4" *ngIf="datosTabla">
    <div class="row">
        <div class="col-lg-12">
            <mat-form-field class="full-width" appearance="outline">
                <mat-label>Buscar {{nombre}}</mat-label>
                <input matInput [(ngModel)]="busquedaElemento" placeholder="Buscar por nombre"
                    (keyup)="aplicarFiltroBusqueda()" autocomplete="off">
                <button *ngIf="busquedaElemento" (click)="borrarBusqueda()" mat-button matSuffix mat-icon-button
                    aria-label="Clear">
                    <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>
        </div>
    </div>
    <div *ngIf="datosTabla" class="row">
        <div class="col-lg-12 mb-4">
            <ng-container [ngSwitch]="nombre">
                <ng-container *ngSwitchCase="'proveedor'">
                    <mat-table [dataSource]="datosTabla" matSort>
                        <ng-container matColumnDef="nombre">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.nombre}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="rfc">
                            <mat-header-cell *matHeaderCellDef>RFC</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.rfc}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="telefono">
                            <mat-header-cell *matHeaderCellDef>Telefono</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.telefono}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="ciudad">
                            <mat-header-cell *matHeaderCellDef>Ciudad</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.ciudad}}</mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'borrar'" matColumnDef="borrar">
                            <mat-header-cell *matHeaderCellDef>Eliminar proveedor</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarEliminacionElemento(element,'proveedor',0)" mat-icon-button
                                    color="warn">
                                    <mat-icon>delete</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'editar'" matColumnDef="editar">
                            <mat-header-cell *matHeaderCellDef>Editar proveedor</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarEdicionProveedor(element)" mat-icon-button>
                                    <mat-icon>edit</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'restaurar'" matColumnDef="restaurar">
                            <mat-header-cell *matHeaderCellDef>Restaurar proveedor</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarRestauracionElemento(element,'proveedor',0)" mat-icon-button
                                    color="primary">
                                    <mat-icon>restore_from_trash</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="noData">
                            <mat-footer-cell *matFooterCellDef colspan="6">
                                No hay {{nombre}}es en esta lista
                            </mat-footer-cell>
                        </ng-container>
                        <mat-header-row *matHeaderRowDef="columnas"></mat-header-row>
                        <mat-row *matRowDef="let row;columns: columnas;"></mat-row>
                        <mat-footer-row *matFooterRowDef="['noData']"
                            [ngClass]="{'hide':!(datosTabla!=null && datosTabla.data.length == 0)}"></mat-footer-row>
                    </mat-table>
                </ng-container>
                <ng-container *ngSwitchCase="'cliente'">
                    <mat-table [dataSource]="datosTabla" matSort>
                        <ng-container matColumnDef="nombre">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.nombre}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="ape_pat">
                            <mat-header-cell *matHeaderCellDef>Apellido paterno</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.ape_pat}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="ape_mat">
                            <mat-header-cell *matHeaderCellDef>Apellido materno</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.ape_mat}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="email">
                            <mat-header-cell *matHeaderCellDef>Correo electronico</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.email}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="telefono">
                            <mat-header-cell *matHeaderCellDef>Telefono celular</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.telefono}}</mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'borrar'" matColumnDef="borrar">
                            <mat-header-cell *matHeaderCellDef>Eliminar cliente</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarEliminacionElemento(element,'cliente',1)" mat-icon-button
                                    color="warn">
                                    <mat-icon>delete</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'editar'" matColumnDef="editar">
                            <mat-header-cell *matHeaderCellDef>Editar cliente</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarEdicionCliente(element)" mat-icon-button>
                                    <mat-icon>edit</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'restaurar'" matColumnDef="restaurar">
                            <mat-header-cell *matHeaderCellDef>Restaurar cliente</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarRestauracionElemento(element,'cliente',1)" mat-icon-button
                                    color="primary">
                                    <mat-icon>restore_from_trash</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="noData">
                            <mat-footer-cell *matFooterCellDef colspan="6">
                                No hay clientes registrados
                            </mat-footer-cell>
                        </ng-container>
                        <mat-header-row *matHeaderRowDef="columnas"></mat-header-row>
                        <mat-row *matRowDef="let row;columns: columnas;"></mat-row>
                        <mat-footer-row *matFooterRowDef="['noData']"
                            [ngClass]="{'hide':!(datosTabla!=null && datosTabla.data.length == 0)}"></mat-footer-row>
                    </mat-table>
                </ng-container>
                <ng-container *ngSwitchCase="'usuario'">
                    <mat-table [dataSource]="datosTabla" matSort>
                        <ng-container matColumnDef="nombre">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.nombre}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="ape_pat">
                            <mat-header-cell *matHeaderCellDef>Apellido paterno</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.ape_pat}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="ape_mat">
                            <mat-header-cell *matHeaderCellDef>Apellido materno</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.ape_mat}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="rol">
                            <mat-header-cell *matHeaderCellDef>Rol</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <span *ngIf="element.rol == 2">Administrador</span>
                                <span *ngIf="element.rol == 1">Supervisor</span>
                                <span *ngIf="element.rol == 0">Empleado</span>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'borrar'" matColumnDef="borrar">
                            <mat-header-cell *matHeaderCellDef>Eliminar usuario</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <button (click)="confirmarEliminacionElemento(element,'usuario',2)"
                                    [disabled]="propiaCuenta(element)" mat-icon-button color="warn">
                                    <mat-icon>delete</mat-icon>
                                </button>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'editar'" matColumnDef="editar">
                            <mat-header-cell *matHeaderCellDef>Editar</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <button mat-icon-button (click)="confirmarEdicionUsuario(element)" class="editar">
                                    <mat-icon>edit</mat-icon>
                                </button>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'editar'" matColumnDef="permisos">
                            <mat-header-cell *matHeaderCellDef>Cambiar permisos</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <button mat-icon-button (click)="cambiarPermisosUsuario(element)"
                                    [disabled]="!esAdministrador()" color="accent">
                                    <mat-icon>lock</mat-icon>
                                </button>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'restaurar'" matColumnDef="restaurar">
                            <mat-header-cell *matHeaderCellDef>Restaurar usuario</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarRestauracionElemento(element,'usuario',2)" mat-icon-button
                                    color="primary">
                                    <mat-icon>restore_from_trash</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="noData">
                            <mat-footer-cell *matFooterCellDef colspan="6">
                                No hay usuarios registrados
                            </mat-footer-cell>
                        </ng-container>
                        <mat-header-row *matHeaderRowDef="columnas"></mat-header-row>
                        <mat-row *matRowDef="let row;columns: columnas;"></mat-row>
                        <mat-footer-row *matFooterRowDef="['noData']"
                            [ngClass]="{'hide':!(datosTabla!=null && datosTabla.data.length == 0)}"></mat-footer-row>
                    </mat-table>
                </ng-container>
                <ng-container *ngSwitchCase="'empresa'">
                    <mat-table [dataSource]="datosTabla" matSort>
                        <ng-container matColumnDef="nombre">
                            <mat-header-cell *matHeaderCellDef mat-sort-header>Nombre</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.nombre}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="contacto">
                            <mat-header-cell *matHeaderCellDef>Contacto</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.contacto}}</mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="email">
                            <mat-header-cell *matHeaderCellDef>Correo electronico</mat-header-cell>
                            <mat-cell *matCellDef="let element">{{element.email}}</mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'editar'" matColumnDef="editar">
                            <mat-header-cell *matHeaderCellDef>Editar empresa</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <button mat-icon-button color="accent" (click)="confirmarEdicionEmpresa(element)">
                                    <mat-icon>edit</mat-icon>
                                </button>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'editar'" matColumnDef="eliminar">
                            <mat-header-cell *matHeaderCellDef>Eliminar empresa</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <button mat-icon-button color="warn"
                                    (click)="confirmarEliminacionElemento(element,'empresa',3)">
                                    <mat-icon>delete</mat-icon>
                                </button>
                            </mat-cell>
                        </ng-container>
                        <ng-container *ngIf="accion == 'restaurar'" matColumnDef="restaurar">
                            <mat-header-cell *matHeaderCellDef>Restaurar empresa</mat-header-cell>
                            <mat-cell *matCellDef="let element">
                                <a (click)="confirmarRestauracionElemento(element,'empresa',3)" mat-icon-button
                                    color="primary">
                                    <mat-icon>restore_from_trash</mat-icon>
                                </a>
                            </mat-cell>
                        </ng-container>
                        <ng-container matColumnDef="noData">
                            <mat-footer-cell *matFooterCellDef colspan="6">
                                No hay empresas registradas
                            </mat-footer-cell>
                        </ng-container>
                        <mat-header-row *matHeaderRowDef="columnas"></mat-header-row>
                        <mat-row *matRowDef="let row;columns: columnas;"></mat-row>
                        <mat-footer-row *matFooterRowDef="['noData']"
                            [ngClass]="{'hide':!(datosTabla!=null && datosTabla.data.length == 0)}"></mat-footer-row>
                    </mat-table>
                </ng-container>
            </ng-container>
            <mat-paginator #paginator [pageSizeOptions]="[5,10,15,20]" [pageSize]="10"></mat-paginator>
        </div>
    </div>
</mat-card>